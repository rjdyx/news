function addNav(){if($("#iswitch").prop("checked"))var a=1;else var a=0;var n=new Array;$(".m-label span").each(function(a){n[a]=new Array,n[a][0]=$(this).text(),$(this).siblings("input").prop("checked")?n[a][1]="1":n[a][1]="0"}),$.ajax({type:"GET",url:$.GetUrl()+"NavAction/addNav",data:{navName:$("#main_nav_name").val(),model:a,subNav:JSON.stringify(n)},dataType:"json",success:function(a){"1"==a&&(toastr.success("新增成功"),setTimeout(function(){window.location.reload()},800))},error:function(){toastr.error("连接失败")}})}function checkName(){""==$("#main_nav_name").val()?$("#subAjax").addClass("disabled"):$("#subAjax").removeClass("disabled")}function checkSubName(){""==$("#sub_nav_name").val()?$("#add_btn").addClass("disabled"):$("#add_btn").removeClass("disabled")}$(function(){$("#main_nav_name").focus()}),jQuery.GetUrl=function(){var a=window.location.pathname.split("/");return"static"==a[1]||a[1].indexOf("Action")>0?"/":"/"+a[1]+"/"},$(function(){function a(){$(".subNavList .linecons-pencil").click(function(a){var n=this,e=$("#edit-subnav #sub_nav_name");$("#edit-subnav").modal("show",{backdrop:"fade"}),e.val($(this).siblings("span").text()),e.on("input",function(a){""===a.target.value?$(".btn-info").addClass("disabled"):$(".btn-info").removeClass("disabled")}),$("#edit-subnav .btn-info").click(function(a){$(n).parent(".m-label").children("span").text(e.val()),n=null})})}var n=$("#main_nav_name"),e=$(".subNavList ul"),i=$("#sub_nav_name"),s=0;$("#add_btn").click(function(n){var t=i.val(),l=$('<li class="m-label"><span>'+t+'</span> <input type="checkbox" id="subnav-'+s+'"/><label class="f-r" for="subnav-'+s+'"></label><i class="linecons-trash f-r"></i><i class="linecons-pencil f-r"></i></li>');$("#sub_nav_name").val(""),s+=1,e.append(l),$(".subNavList .linecons-trash").click(function(a){$(this).parent().remove()}),a()}),$(".panel").delegate("#subAjax","click",function(a){var i=(n.val(),[]);$.each(e.children(".m-label"),function(a,n){i.push($(n).children("span").text())})})});

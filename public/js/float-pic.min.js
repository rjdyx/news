function init(){$(":checkbox[name=select_news]").each(function(){$(this).click(function(){$(this).prop("checked")&&($(":checkbox[name=select_news]").removeProp("checked"),$(this).prop("checked","checked"),$("#commitBtn").removeClass("disabled")),$(this).prop("checked")||$("#commitBtn").addClass("disabled")})})}function saveChange(){$.ajax({type:"GET",url:$.GetUrl()+"FloatPicAction/saveChange",data:{pic:$(".pic").attr("src"),flag:$("input[type='checkbox']").is(":checked"),id:$("#news_id").val(),title:$("#news_title").text()},dataType:"json",success:function(e){"1"==e&&(toastr.success("保存成功"),setTimeout(function(){window.location.reload()},800))},error:function(){toastr.error("连接失败")}})}function getAllNews(e){$.ajax({type:"GET",url:$.GetUrl()+"FloatPicAction/getAllNews",data:{index:e},dataType:"json",success:function(e){$("#newsList").children().remove();for(var i="",n=0;n<e.newsList.length;n++)i+='<li class="list-group-item"><span class="news-title" id='+e.newsList[n].id+">"+e.newsList[n].title+'</span> <input type="checkbox"  class="f-r" name="select_news" /></li>';$("#newsList").append(i),$(".pagination").children().remove(),i="",e.begin>1&&(i+='<li><a href="#" onclick="getAllNews('+(e.index-1)+')">&laquo;</a></li><li><a href="#" onclick="getAllNews('+e.index+')">1...</a></li>');for(var n=e.begin;n<=e.end;n++)i+=" <li "+(n==e.index?'class="active"':"")+'><a href="#" onclick="getAllNews('+n+')">'+n+"</a></li>";e.end<e.pageCount&&(i+='<li><a href="#" onclick="getAllNews('+e.pageCount+')">...'+e.pageCount+'</a></li><li><a href="#" onclick="getAllNews('+(e.index+1)+')">&raquo;</a></li>'),i+='<li><a href="#">第'+e.index+"/"+e.pageCount+"页</a></li>",$(".pagination").append(i),init()},error:function(){toastr.error("连接失败")}})}function searchNews(e){$.ajax({type:"GET",url:$.GetUrl()+"FloatPicAction/searchNews",data:{index:e,name:$("#searchName").val()},dataType:"json",success:function(e){$("#newsList").children().remove();for(var i="",n=0;n<e.newsList.length;n++)i+='<li class="list-group-item"><span class="news-title" id='+e.newsList[n].id+">"+e.newsList[n].title+'</span> <input type="checkbox"  class="f-r" name="select_news" /></li>';$("#newsList").append(i),$(".pagination").children().remove(),i="",e.begin>1&&(i+='<li><a href="#" onclick="searchNews('+(e.index-1)+')">&laquo;</a></li><li><a href="#" onclick="searchNews('+e.index+')">1...</a></li>');for(var n=e.begin;n<=e.end;n++)i+=" <li "+(n==e.index?'class="active"':"")+'><a href="#" onclick="searchNews('+n+')">'+n+"</a></li>";e.end<e.pageCount&&(i+='<li><a href="#" onclick="searchNews('+e.pageCount+')">...${pageCount}</a></li><li><a href="#" onclick="searchNews('+(e.index+1)+')">&raquo;</a></li>'),i+='<li><a href="#">第'+e.index+"/"+e.pageCount+"页</a></li>",$(".pagination").append(i),init()},error:function(){toastr.error("连接失败")}})}function referNews(){$(":checkbox[name=select_news]:checkbox:checked").each(function(){$("#news_id").val($(this).siblings().attr("id")),$("#news_title").text($(this).siblings().text())})}jQuery.GetUrl=function(){var e=window.location.pathname.split("/");return"static"==e[1]||e[1].indexOf("Action")>0?"/":"/"+e[1]+"/"},$(function(){$("#choose_news").click(function(e){$("#news-list").modal("show",{backdrop:"fade"}),getAllNews(1)})});
function showCheck(i){var t=document.getElementById("myCanvas"),r=t.getContext("2d");r.clearRect(0,0,1e3,1e3),r.font="80px Arial",r.fillText(i,0,100)}function createCode(i){var t=4;new Array(1,2,3,4,5,6,7,8,9,"a","b","c","d","e","f","g","h","j","k","l","m","n","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","W","X","Y","Z"),i.length!=t&&createCode(i),showCheck(i)}function getCode(){$.ajax({type:"GET",url:"/getCode",success:function(i){createCode(i)},error:function(){}})}function showCheck(i){var t=document.getElementById("myCanvas"),r=t.getContext("2d");r.clearRect(0,0,1e3,1e3),r.font="80px Arial",r.fillText(i,0,100)}function createCode(i){var t=4;new Array(1,2,3,4,5,6,7,8,9,"a","b","c","d","e","f","g","h","j","k","l","m","n","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","W","X","Y","Z"),i.length!=t&&createCode(i),showCheck(i)}function getCode(){$.ajax({type:"GET",url:"/getCode",success:function(i){createCode(i)},error:function(){}})}function showCheck(i){var t=document.getElementById("myCanvas"),r=t.getContext("2d");r.clearRect(0,0,1e3,1e3),r.font="80px Arial",r.fillText(i,0,100)}function createCode(i){var t=4;new Array(1,2,3,4,5,6,7,8,9,"a","b","c","d","e","f","g","h","j","k","l","m","n","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","W","X","Y","Z");i.length!=t&&createCode(i),showCheck(i)}function getCode(){$.ajax({type:"GET",url:"/getCode",success:function(i){createCode(i)},error:function(){}})}!function(t){function r(i){var t=s,r=t.biDivideByRadixPower(i,this.k-1),e=t.biMultiply(r,this.mu),n=t.biDivideByRadixPower(e,this.k+1),g=t.biModuloByRadixPower(i,this.k+1),d=t.biMultiply(n,this.modulus),o=t.biModuloByRadixPower(d,this.k+1),u=t.biSubtract(g,o);u.isNeg&&(u=t.biAdd(u,this.bkplus1));for(var a=t.biCompare(u,this.modulus)>=0;a;)u=t.biSubtract(u,this.modulus),a=t.biCompare(u,this.modulus)>=0;return u}function e(i,t){var r=s.biMultiply(i,t);return this.modulo(r)}function n(i,t){var r=new v;r.digits[0]=1;for(var e=i,n=t;0!=(1&n.digits[0])&&(r=this.multiplyMod(r,e)),n=s.biShiftRight(n,1),0!=n.digits[0]||0!=s.biHighIndex(n);)e=this.multiplyMod(e,e);return r}if("undefined"==typeof t.RSAUtils)var s=t.RSAUtils={};var g,d,o,u,a=16,b=a,l=65536,h=l>>>1,f=l*l,c=l-1,v=t.BigInt=function(i){"boolean"==typeof i&&1==i?this.digits=null:this.digits=d.slice(0),this.isNeg=!1};s.setMaxDigits=function(i){g=i,d=new Array(g);for(var t=0;t<d.length;t++)d[t]=0;o=new v,u=new v,u.digits[0]=1},s.setMaxDigits(20);var N=15;s.biFromNumber=function(i){var t=new v;t.isNeg=0>i,i=Math.abs(i);for(var r=0;i>0;)t.digits[r++]=i&c,i=Math.floor(i/l);return t};var m=s.biFromNumber(1e15);s.biFromDecimal=function(i){for(var t,r="-"==i.charAt(0),e=r?1:0;e<i.length&&"0"==i.charAt(e);)++e;if(e==i.length)t=new v;else{var n=i.length-e,g=n%N;for(0==g&&(g=N),t=s.biFromNumber(Number(i.substr(e,g))),e+=g;e<i.length;)t=s.biAdd(s.biMultiply(t,m),s.biFromNumber(Number(i.substr(e,N)))),e+=N;t.isNeg=r}return t},s.biCopy=function(i){var t=new v(!0);return t.digits=i.digits.slice(0),t.isNeg=i.isNeg,t},s.reverseStr=function(i){for(var t="",r=i.length-1;r>-1;--r)t+=i.charAt(r);return t};var y=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];s.biToString=function(i,t){var r=new v;r.digits[0]=t;for(var e=s.biDivideModulo(i,r),n=y[e[1].digits[0]];1==s.biCompare(e[0],o);)e=s.biDivideModulo(e[0],r),digit=e[1].digits[0],n+=y[e[1].digits[0]];return(i.isNeg?"-":"")+s.reverseStr(n)},s.biToDecimal=function(i){var t=new v;t.digits[0]=10;for(var r=s.biDivideModulo(i,t),e=String(r[1].digits[0]);1==s.biCompare(r[0],o);)r=s.biDivideModulo(r[0],t),e+=String(r[1].digits[0]);return(i.isNeg?"-":"")+s.reverseStr(e)};var M=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];s.digitToHex=function(t){var r=15,e="";for(i=0;i<4;++i)e+=M[t&r],t>>>=4;return s.reverseStr(e)},s.biToHex=function(i){for(var t="",r=(s.biHighIndex(i),s.biHighIndex(i));r>-1;--r)t+=s.digitToHex(i.digits[r]);return t},s.charToHex=function(i){var t,r=48,e=r+9,n=97,s=n+25,g=65,d=90;return t=i>=r&&e>=i?i-r:i>=g&&d>=i?10+i-g:i>=n&&s>=i?10+i-n:0},s.hexToDigit=function(i){for(var t=0,r=Math.min(i.length,4),e=0;r>e;++e)t<<=4,t|=s.charToHex(i.charCodeAt(e));return t},s.biFromHex=function(i){for(var t=new v,r=i.length,e=r,n=0;e>0;e-=4,++n)t.digits[n]=s.hexToDigit(i.substr(Math.max(e-4,0),Math.min(e,4)));return t},s.biFromString=function(i,t){var r="-"==i.charAt(0),e=r?1:0,n=new v,g=new v;g.digits[0]=1;for(var d=i.length-1;d>=e;d--){var o=i.charCodeAt(d),u=s.charToHex(o),a=s.biMultiplyDigit(g,u);n=s.biAdd(n,a),g=s.biMultiplyDigit(g,t)}return n.isNeg=r,n},s.biDump=function(i){return(i.isNeg?"-":"")+i.digits.join(" ")},s.biAdd=function(i,t){var r;if(i.isNeg!=t.isNeg)t.isNeg=!t.isNeg,r=s.biSubtract(i,t),t.isNeg=!t.isNeg;else{r=new v;for(var e,n=0,g=0;g<i.digits.length;++g)e=i.digits[g]+t.digits[g]+n,r.digits[g]=e%l,n=Number(e>=l);r.isNeg=i.isNeg}return r},s.biSubtract=function(i,t){var r;if(i.isNeg!=t.isNeg)t.isNeg=!t.isNeg,r=s.biAdd(i,t),t.isNeg=!t.isNeg;else{r=new v;var e,n;n=0;for(var g=0;g<i.digits.length;++g)e=i.digits[g]-t.digits[g]+n,r.digits[g]=e%l,r.digits[g]<0&&(r.digits[g]+=l),n=0-Number(0>e);if(-1==n){n=0;for(var g=0;g<i.digits.length;++g)e=0-r.digits[g]+n,r.digits[g]=e%l,r.digits[g]<0&&(r.digits[g]+=l),n=0-Number(0>e);r.isNeg=!i.isNeg}else r.isNeg=i.isNeg}return r},s.biHighIndex=function(i){for(var t=i.digits.length-1;t>0&&0==i.digits[t];)--t;return t},s.biNumBits=function(i){var t,r=s.biHighIndex(i),e=i.digits[r],n=(r+1)*b;for(t=n;t>n-b&&0==(32768&e);--t)e<<=1;return t},s.biMultiply=function(i,t){for(var r,e,n,g=new v,d=s.biHighIndex(i),o=s.biHighIndex(t),u=0;o>=u;++u){for(r=0,n=u,j=0;j<=d;++j,++n)e=g.digits[n]+i.digits[j]*t.digits[u]+r,g.digits[n]=e&c,r=e>>>a;g.digits[u+d+1]=r}return g.isNeg=i.isNeg!=t.isNeg,g},s.biMultiplyDigit=function(i,t){var r,e,n;result=new v,r=s.biHighIndex(i),e=0;for(var g=0;r>=g;++g)n=result.digits[g]+i.digits[g]*t+e,result.digits[g]=n&c,e=n>>>a;return result.digits[1+r]=e,result},s.arrayCopy=function(i,t,r,e,n){for(var s=Math.min(t+n,i.length),g=t,d=e;s>g;++g,++d)r[d]=i[g]};var p=[0,32768,49152,57344,61440,63488,64512,65024,65280,65408,65472,65504,65520,65528,65532,65534,65535];s.biShiftLeft=function(i,t){var r=Math.floor(t/b),e=new v;s.arrayCopy(i.digits,0,e.digits,r,e.digits.length-r);for(var n=t%b,g=b-n,d=e.digits.length-1,o=d-1;d>0;--d,--o)e.digits[d]=e.digits[d]<<n&c|(e.digits[o]&p[n])>>>g;return e.digits[0]=e.digits[d]<<n&c,e.isNeg=i.isNeg,e};var w=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];s.biShiftRight=function(i,t){var r=Math.floor(t/b),e=new v;s.arrayCopy(i.digits,r,e.digits,0,i.digits.length-r);for(var n=t%b,g=b-n,d=0,o=d+1;d<e.digits.length-1;++d,++o)e.digits[d]=e.digits[d]>>>n|(e.digits[o]&w[n])<<g;return e.digits[e.digits.length-1]>>>=n,e.isNeg=i.isNeg,e},s.biMultiplyByRadixPower=function(i,t){var r=new v;return s.arrayCopy(i.digits,0,r.digits,t,r.digits.length-t),r},s.biDivideByRadixPower=function(i,t){var r=new v;return s.arrayCopy(i.digits,t,r.digits,0,r.digits.length-t),r},s.biModuloByRadixPower=function(i,t){var r=new v;return s.arrayCopy(i.digits,0,r.digits,0,t),r},s.biCompare=function(i,t){if(i.isNeg!=t.isNeg)return 1-2*Number(i.isNeg);for(var r=i.digits.length-1;r>=0;--r)if(i.digits[r]!=t.digits[r])return i.isNeg?1-2*Number(i.digits[r]>t.digits[r]):1-2*Number(i.digits[r]<t.digits[r]);return 0},s.biDivideModulo=function(i,t){var r,e,n=s.biNumBits(i),g=s.biNumBits(t),d=t.isNeg;if(g>n)return i.isNeg?(r=s.biCopy(u),r.isNeg=!t.isNeg,i.isNeg=!1,t.isNeg=!1,e=biSubtract(t,i),i.isNeg=!0,t.isNeg=d):(r=new v,e=s.biCopy(i)),[r,e];r=new v,e=i;for(var o=Math.ceil(g/b)-1,a=0;t.digits[o]<h;)t=s.biShiftLeft(t,1),++a,++g,o=Math.ceil(g/b)-1;e=s.biShiftLeft(e,a),n+=a;for(var N=Math.ceil(n/b)-1,m=s.biMultiplyByRadixPower(t,N-o);-1!=s.biCompare(e,m);)++r.digits[N-o],e=s.biSubtract(e,m);for(var y=N;y>o;--y){var M=y>=e.digits.length?0:e.digits[y],p=y-1>=e.digits.length?0:e.digits[y-1],w=y-2>=e.digits.length?0:e.digits[y-2],x=o>=t.digits.length?0:t.digits[o],S=o-1>=t.digits.length?0:t.digits[o-1];M==x?r.digits[y-o-1]=c:r.digits[y-o-1]=Math.floor((M*l+p)/x);for(var C=r.digits[y-o-1]*(x*l+S),D=M*f+(p*l+w);C>D;)--r.digits[y-o-1],C=r.digits[y-o-1]*(x*l|S),D=M*l*l+(p*l+w);m=s.biMultiplyByRadixPower(t,y-o-1),e=s.biSubtract(e,s.biMultiplyDigit(m,r.digits[y-o-1])),e.isNeg&&(e=s.biAdd(e,m),--r.digits[y-o-1])}return e=s.biShiftRight(e,a),r.isNeg=i.isNeg!=d,i.isNeg&&(r=d?s.biAdd(r,u):s.biSubtract(r,u),t=s.biShiftRight(t,a),e=s.biSubtract(t,e)),0==e.digits[0]&&0==s.biHighIndex(e)&&(e.isNeg=!1),[r,e]},s.biDivide=function(i,t){return s.biDivideModulo(i,t)[0]},s.biModulo=function(i,t){return s.biDivideModulo(i,t)[1]},s.biMultiplyMod=function(i,t,r){return s.biModulo(s.biMultiply(i,t),r)},s.biPow=function(i,t){for(var r=u,e=i;0!=(1&t)&&(r=s.biMultiply(r,e)),t>>=1,0!=t;)e=s.biMultiply(e,e);return r},s.biPowMod=function(i,t,r){for(var e=u,n=i,g=t;0!=(1&g.digits[0])&&(e=s.biMultiplyMod(e,n,r)),g=s.biShiftRight(g,1),0!=g.digits[0]||0!=s.biHighIndex(g);)n=s.biMultiplyMod(n,n,r);return e},t.BarrettMu=function(i){this.modulus=s.biCopy(i),this.k=s.biHighIndex(this.modulus)+1;var t=new v;t.digits[2*this.k]=1,this.mu=s.biDivide(t,this.modulus),this.bkplus1=new v,this.bkplus1.digits[this.k+1]=1,this.modulo=r,this.multiplyMod=e,this.powMod=n};var x=function(i,r,e){var n=s;this.e=n.biFromHex(i),this.d=n.biFromHex(r),this.m=n.biFromHex(e),this.chunkSize=2*n.biHighIndex(this.m),this.radix=16,this.barrett=new t.BarrettMu(this.m)};s.getKeyPair=function(i,t,r){return new x(i,t,r)},"undefined"==typeof t.twoDigit&&(t.twoDigit=function(i){return(10>i?"0":"")+String(i)}),s.encryptedString=function(i,t){for(var r=[],e=t.length,n=0;e>n;)r[n]=t.charCodeAt(n),n++;for(;r.length%i.chunkSize!=0;)r[n++]=0;var g,d,o,u=r.length,a="";for(n=0;u>n;n+=i.chunkSize){for(o=new v,g=0,d=n;d<n+i.chunkSize;++g)o.digits[g]=r[d++],o.digits[g]+=r[d++]<<8;var b=i.barrett.powMod(o,i.e),l=16==i.radix?s.biToHex(b):s.biToString(b,i.radix);a+=l+" "}return a.substring(0,a.length-1)},s.decryptedString=function(i,t){var r,e,n,g=t.split(" "),d="";for(r=0;r<g.length;++r){var o;for(o=16==i.radix?s.biFromHex(g[r]):s.biFromString(g[r],i.radix),n=i.barrett.powMod(o,i.d),e=0;e<=s.biHighIndex(n);++e)d+=String.fromCharCode(255&n.digits[e],n.digits[e]>>8)}return 0==d.charCodeAt(d.length-1)&&(d=d.substring(0,d.length-1)),d},s.setMaxDigits(130)}(window),function(t){function r(i){var t=s,r=t.biDivideByRadixPower(i,this.k-1),e=t.biMultiply(r,this.mu),n=t.biDivideByRadixPower(e,this.k+1),g=t.biModuloByRadixPower(i,this.k+1),d=t.biMultiply(n,this.modulus),o=t.biModuloByRadixPower(d,this.k+1),u=t.biSubtract(g,o);u.isNeg&&(u=t.biAdd(u,this.bkplus1));for(var a=t.biCompare(u,this.modulus)>=0;a;)u=t.biSubtract(u,this.modulus),a=t.biCompare(u,this.modulus)>=0;return u}function e(i,t){var r=s.biMultiply(i,t);return this.modulo(r)}function n(i,t){var r=new v;r.digits[0]=1;for(var e=i,n=t;0!=(1&n.digits[0])&&(r=this.multiplyMod(r,e)),n=s.biShiftRight(n,1),0!=n.digits[0]||0!=s.biHighIndex(n);)e=this.multiplyMod(e,e);return r}if("undefined"==typeof t.RSAUtils)var s=t.RSAUtils={};var g,d,o,u,a=16,b=a,l=65536,h=l>>>1,f=l*l,c=l-1,v=t.BigInt=function(i){"boolean"==typeof i&&1==i?this.digits=null:this.digits=d.slice(0),this.isNeg=!1};s.setMaxDigits=function(i){g=i,d=new Array(g);for(var t=0;t<d.length;t++)d[t]=0;o=new v,u=new v,u.digits[0]=1},s.setMaxDigits(20);var N=15;s.biFromNumber=function(i){var t=new v;t.isNeg=0>i,i=Math.abs(i);for(var r=0;i>0;)t.digits[r++]=i&c,i=Math.floor(i/l);return t};var m=s.biFromNumber(1e15);s.biFromDecimal=function(i){for(var t,r="-"==i.charAt(0),e=r?1:0;e<i.length&&"0"==i.charAt(e);)++e;if(e==i.length)t=new v;else{var n=i.length-e,g=n%N;for(0==g&&(g=N),t=s.biFromNumber(Number(i.substr(e,g))),e+=g;e<i.length;)t=s.biAdd(s.biMultiply(t,m),s.biFromNumber(Number(i.substr(e,N)))),e+=N;t.isNeg=r}return t},s.biCopy=function(i){var t=new v(!0);return t.digits=i.digits.slice(0),t.isNeg=i.isNeg,t},s.reverseStr=function(i){for(var t="",r=i.length-1;r>-1;--r)t+=i.charAt(r);return t};var y=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];s.biToString=function(i,t){var r=new v;r.digits[0]=t;for(var e=s.biDivideModulo(i,r),n=y[e[1].digits[0]];1==s.biCompare(e[0],o);)e=s.biDivideModulo(e[0],r),digit=e[1].digits[0],n+=y[e[1].digits[0]];return(i.isNeg?"-":"")+s.reverseStr(n)},s.biToDecimal=function(i){var t=new v;t.digits[0]=10;for(var r=s.biDivideModulo(i,t),e=String(r[1].digits[0]);1==s.biCompare(r[0],o);)r=s.biDivideModulo(r[0],t),e+=String(r[1].digits[0]);return(i.isNeg?"-":"")+s.reverseStr(e)};var M=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];s.digitToHex=function(t){var r=15,e="";for(i=0;i<4;++i)e+=M[t&r],t>>>=4;return s.reverseStr(e)},s.biToHex=function(i){for(var t="",r=(s.biHighIndex(i),s.biHighIndex(i));r>-1;--r)t+=s.digitToHex(i.digits[r]);return t},s.charToHex=function(i){var t,r=48,e=r+9,n=97,s=n+25,g=65,d=90;return t=i>=r&&e>=i?i-r:i>=g&&d>=i?10+i-g:i>=n&&s>=i?10+i-n:0},s.hexToDigit=function(i){for(var t=0,r=Math.min(i.length,4),e=0;r>e;++e)t<<=4,t|=s.charToHex(i.charCodeAt(e));return t},s.biFromHex=function(i){for(var t=new v,r=i.length,e=r,n=0;e>0;e-=4,++n)t.digits[n]=s.hexToDigit(i.substr(Math.max(e-4,0),Math.min(e,4)));return t},s.biFromString=function(i,t){var r="-"==i.charAt(0),e=r?1:0,n=new v,g=new v;g.digits[0]=1;for(var d=i.length-1;d>=e;d--){var o=i.charCodeAt(d),u=s.charToHex(o),a=s.biMultiplyDigit(g,u);n=s.biAdd(n,a),g=s.biMultiplyDigit(g,t)}return n.isNeg=r,n},s.biDump=function(i){return(i.isNeg?"-":"")+i.digits.join(" ")},s.biAdd=function(i,t){var r;if(i.isNeg!=t.isNeg)t.isNeg=!t.isNeg,r=s.biSubtract(i,t),t.isNeg=!t.isNeg;else{r=new v;for(var e,n=0,g=0;g<i.digits.length;++g)e=i.digits[g]+t.digits[g]+n,r.digits[g]=e%l,n=Number(e>=l);r.isNeg=i.isNeg}return r},s.biSubtract=function(i,t){var r;if(i.isNeg!=t.isNeg)t.isNeg=!t.isNeg,r=s.biAdd(i,t),t.isNeg=!t.isNeg;else{r=new v;var e,n;n=0;for(var g=0;g<i.digits.length;++g)e=i.digits[g]-t.digits[g]+n,r.digits[g]=e%l,r.digits[g]<0&&(r.digits[g]+=l),n=0-Number(0>e);if(-1==n){n=0;for(var g=0;g<i.digits.length;++g)e=0-r.digits[g]+n,r.digits[g]=e%l,r.digits[g]<0&&(r.digits[g]+=l),n=0-Number(0>e);r.isNeg=!i.isNeg}else r.isNeg=i.isNeg}return r},s.biHighIndex=function(i){for(var t=i.digits.length-1;t>0&&0==i.digits[t];)--t;return t},s.biNumBits=function(i){var t,r=s.biHighIndex(i),e=i.digits[r],n=(r+1)*b;for(t=n;t>n-b&&0==(32768&e);--t)e<<=1;return t},s.biMultiply=function(i,t){for(var r,e,n,g=new v,d=s.biHighIndex(i),o=s.biHighIndex(t),u=0;o>=u;++u){for(r=0,n=u,j=0;j<=d;++j,++n)e=g.digits[n]+i.digits[j]*t.digits[u]+r,g.digits[n]=e&c,r=e>>>a;g.digits[u+d+1]=r}return g.isNeg=i.isNeg!=t.isNeg,g},s.biMultiplyDigit=function(i,t){var r,e,n;result=new v,r=s.biHighIndex(i),e=0;for(var g=0;r>=g;++g)n=result.digits[g]+i.digits[g]*t+e,result.digits[g]=n&c,e=n>>>a;return result.digits[1+r]=e,result},s.arrayCopy=function(i,t,r,e,n){for(var s=Math.min(t+n,i.length),g=t,d=e;s>g;++g,++d)r[d]=i[g]};var p=[0,32768,49152,57344,61440,63488,64512,65024,65280,65408,65472,65504,65520,65528,65532,65534,65535];s.biShiftLeft=function(i,t){var r=Math.floor(t/b),e=new v;s.arrayCopy(i.digits,0,e.digits,r,e.digits.length-r);for(var n=t%b,g=b-n,d=e.digits.length-1,o=d-1;d>0;--d,--o)e.digits[d]=e.digits[d]<<n&c|(e.digits[o]&p[n])>>>g;return e.digits[0]=e.digits[d]<<n&c,e.isNeg=i.isNeg,e};var w=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];s.biShiftRight=function(i,t){var r=Math.floor(t/b),e=new v;s.arrayCopy(i.digits,r,e.digits,0,i.digits.length-r);for(var n=t%b,g=b-n,d=0,o=d+1;d<e.digits.length-1;++d,++o)e.digits[d]=e.digits[d]>>>n|(e.digits[o]&w[n])<<g;return e.digits[e.digits.length-1]>>>=n,e.isNeg=i.isNeg,e},s.biMultiplyByRadixPower=function(i,t){var r=new v;return s.arrayCopy(i.digits,0,r.digits,t,r.digits.length-t),r},s.biDivideByRadixPower=function(i,t){var r=new v;return s.arrayCopy(i.digits,t,r.digits,0,r.digits.length-t),r},s.biModuloByRadixPower=function(i,t){var r=new v;return s.arrayCopy(i.digits,0,r.digits,0,t),r},s.biCompare=function(i,t){if(i.isNeg!=t.isNeg)return 1-2*Number(i.isNeg);for(var r=i.digits.length-1;r>=0;--r)if(i.digits[r]!=t.digits[r])return i.isNeg?1-2*Number(i.digits[r]>t.digits[r]):1-2*Number(i.digits[r]<t.digits[r]);return 0},s.biDivideModulo=function(i,t){var r,e,n=s.biNumBits(i),g=s.biNumBits(t),d=t.isNeg;if(g>n)return i.isNeg?(r=s.biCopy(u),r.isNeg=!t.isNeg,i.isNeg=!1,t.isNeg=!1,e=biSubtract(t,i),i.isNeg=!0,t.isNeg=d):(r=new v,e=s.biCopy(i)),[r,e];r=new v,e=i;for(var o=Math.ceil(g/b)-1,a=0;t.digits[o]<h;)t=s.biShiftLeft(t,1),++a,++g,o=Math.ceil(g/b)-1;e=s.biShiftLeft(e,a),n+=a;for(var N=Math.ceil(n/b)-1,m=s.biMultiplyByRadixPower(t,N-o);-1!=s.biCompare(e,m);)++r.digits[N-o],e=s.biSubtract(e,m);for(var y=N;y>o;--y){var M=y>=e.digits.length?0:e.digits[y],p=y-1>=e.digits.length?0:e.digits[y-1],w=y-2>=e.digits.length?0:e.digits[y-2],x=o>=t.digits.length?0:t.digits[o],S=o-1>=t.digits.length?0:t.digits[o-1];M==x?r.digits[y-o-1]=c:r.digits[y-o-1]=Math.floor((M*l+p)/x);for(var C=r.digits[y-o-1]*(x*l+S),D=M*f+(p*l+w);C>D;)--r.digits[y-o-1],C=r.digits[y-o-1]*(x*l|S),D=M*l*l+(p*l+w);m=s.biMultiplyByRadixPower(t,y-o-1),e=s.biSubtract(e,s.biMultiplyDigit(m,r.digits[y-o-1])),e.isNeg&&(e=s.biAdd(e,m),--r.digits[y-o-1])}return e=s.biShiftRight(e,a),r.isNeg=i.isNeg!=d,i.isNeg&&(r=d?s.biAdd(r,u):s.biSubtract(r,u),t=s.biShiftRight(t,a),e=s.biSubtract(t,e)),0==e.digits[0]&&0==s.biHighIndex(e)&&(e.isNeg=!1),[r,e]},s.biDivide=function(i,t){return s.biDivideModulo(i,t)[0]},s.biModulo=function(i,t){return s.biDivideModulo(i,t)[1]},s.biMultiplyMod=function(i,t,r){return s.biModulo(s.biMultiply(i,t),r)},s.biPow=function(i,t){for(var r=u,e=i;0!=(1&t)&&(r=s.biMultiply(r,e)),t>>=1,0!=t;)e=s.biMultiply(e,e);return r},s.biPowMod=function(i,t,r){for(var e=u,n=i,g=t;0!=(1&g.digits[0])&&(e=s.biMultiplyMod(e,n,r)),g=s.biShiftRight(g,1),0!=g.digits[0]||0!=s.biHighIndex(g);)n=s.biMultiplyMod(n,n,r);return e},t.BarrettMu=function(i){this.modulus=s.biCopy(i),this.k=s.biHighIndex(this.modulus)+1;var t=new v;t.digits[2*this.k]=1,this.mu=s.biDivide(t,this.modulus),this.bkplus1=new v,this.bkplus1.digits[this.k+1]=1,this.modulo=r,this.multiplyMod=e,this.powMod=n};var x=function(i,r,e){var n=s;this.e=n.biFromHex(i),this.d=n.biFromHex(r),this.m=n.biFromHex(e),this.chunkSize=2*n.biHighIndex(this.m),this.radix=16,this.barrett=new t.BarrettMu(this.m)};s.getKeyPair=function(i,t,r){return new x(i,t,r)},"undefined"==typeof t.twoDigit&&(t.twoDigit=function(i){return(10>i?"0":"")+String(i)}),s.encryptedString=function(i,t){for(var r=[],e=t.length,n=0;e>n;)r[n]=t.charCodeAt(n),n++;for(;r.length%i.chunkSize!=0;)r[n++]=0;var g,d,o,u=r.length,a="";for(n=0;u>n;n+=i.chunkSize){for(o=new v,g=0,d=n;d<n+i.chunkSize;++g)o.digits[g]=r[d++],o.digits[g]+=r[d++]<<8;var b=i.barrett.powMod(o,i.e),l=16==i.radix?s.biToHex(b):s.biToString(b,i.radix);a+=l+" "}return a.substring(0,a.length-1)},s.decryptedString=function(i,t){var r,e,n,g=t.split(" "),d="";for(r=0;r<g.length;++r){var o;for(o=16==i.radix?s.biFromHex(g[r]):s.biFromString(g[r],i.radix),n=i.barrett.powMod(o,i.d),e=0;e<=s.biHighIndex(n);++e)d+=String.fromCharCode(255&n.digits[e],n.digits[e]>>8)}return 0==d.charCodeAt(d.length-1)&&(d=d.substring(0,d.length-1)),d},s.setMaxDigits(130)}(window),function(t){function r(i){var t=s,r=t.biDivideByRadixPower(i,this.k-1),e=t.biMultiply(r,this.mu),n=t.biDivideByRadixPower(e,this.k+1),g=t.biModuloByRadixPower(i,this.k+1),d=t.biMultiply(n,this.modulus),o=t.biModuloByRadixPower(d,this.k+1),u=t.biSubtract(g,o);u.isNeg&&(u=t.biAdd(u,this.bkplus1));for(var a=t.biCompare(u,this.modulus)>=0;a;)u=t.biSubtract(u,this.modulus),a=t.biCompare(u,this.modulus)>=0;return u}function e(i,t){var r=s.biMultiply(i,t);return this.modulo(r)}function n(i,t){var r=new v;r.digits[0]=1;for(var e=i,n=t;;){if(0!=(1&n.digits[0])&&(r=this.multiplyMod(r,e)),n=s.biShiftRight(n,1),0==n.digits[0]&&0==s.biHighIndex(n))break;e=this.multiplyMod(e,e)}return r}if("undefined"==typeof t.RSAUtils)var s=t.RSAUtils={};var g,d,o,u,a=16,b=a,l=65536,h=l>>>1,f=l*l,c=l-1,v=t.BigInt=function(i){"boolean"==typeof i&&1==i?this.digits=null:this.digits=d.slice(0),this.isNeg=!1};s.setMaxDigits=function(i){g=i,d=new Array(g);for(var t=0;t<d.length;t++)d[t]=0;o=new v,u=new v,u.digits[0]=1},s.setMaxDigits(20);var N=15;s.biFromNumber=function(i){var t=new v;t.isNeg=0>i,i=Math.abs(i);for(var r=0;i>0;)t.digits[r++]=i&c,i=Math.floor(i/l);return t};var m=s.biFromNumber(1e15);s.biFromDecimal=function(i){for(var t,r="-"==i.charAt(0),e=r?1:0;e<i.length&&"0"==i.charAt(e);)++e;if(e==i.length)t=new v;else{var n=i.length-e,g=n%N;for(0==g&&(g=N),t=s.biFromNumber(Number(i.substr(e,g))),e+=g;e<i.length;)t=s.biAdd(s.biMultiply(t,m),s.biFromNumber(Number(i.substr(e,N)))),e+=N;t.isNeg=r}return t},s.biCopy=function(i){var t=new v(!0);return t.digits=i.digits.slice(0),t.isNeg=i.isNeg,t},s.reverseStr=function(i){for(var t="",r=i.length-1;r>-1;--r)t+=i.charAt(r);return t};var y=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];s.biToString=function(i,t){var r=new v;r.digits[0]=t;for(var e=s.biDivideModulo(i,r),n=y[e[1].digits[0]];1==s.biCompare(e[0],o);)e=s.biDivideModulo(e[0],r),digit=e[1].digits[0],n+=y[e[1].digits[0]];return(i.isNeg?"-":"")+s.reverseStr(n)},s.biToDecimal=function(i){var t=new v;t.digits[0]=10;for(var r=s.biDivideModulo(i,t),e=String(r[1].digits[0]);1==s.biCompare(r[0],o);)r=s.biDivideModulo(r[0],t),e+=String(r[1].digits[0]);return(i.isNeg?"-":"")+s.reverseStr(e)};var M=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];s.digitToHex=function(t){var r=15,e="";for(i=0;i<4;++i)e+=M[t&r],t>>>=4;return s.reverseStr(e)},s.biToHex=function(i){for(var t="",r=(s.biHighIndex(i),s.biHighIndex(i));r>-1;--r)t+=s.digitToHex(i.digits[r]);return t},s.charToHex=function(i){var t,r=48,e=r+9,n=97,s=n+25,g=65,d=90;return t=i>=r&&e>=i?i-r:i>=g&&d>=i?10+i-g:i>=n&&s>=i?10+i-n:0},s.hexToDigit=function(i){for(var t=0,r=Math.min(i.length,4),e=0;r>e;++e)t<<=4,t|=s.charToHex(i.charCodeAt(e));return t},s.biFromHex=function(i){for(var t=new v,r=i.length,e=r,n=0;e>0;e-=4,++n)t.digits[n]=s.hexToDigit(i.substr(Math.max(e-4,0),Math.min(e,4)));return t},s.biFromString=function(i,t){var r="-"==i.charAt(0),e=r?1:0,n=new v,g=new v;g.digits[0]=1;for(var d=i.length-1;d>=e;d--){var o=i.charCodeAt(d),u=s.charToHex(o),a=s.biMultiplyDigit(g,u);n=s.biAdd(n,a),g=s.biMultiplyDigit(g,t)}return n.isNeg=r,n},s.biDump=function(i){return(i.isNeg?"-":"")+i.digits.join(" ")},s.biAdd=function(i,t){var r;if(i.isNeg!=t.isNeg)t.isNeg=!t.isNeg,r=s.biSubtract(i,t),t.isNeg=!t.isNeg;else{r=new v;for(var e,n=0,g=0;g<i.digits.length;++g)e=i.digits[g]+t.digits[g]+n,r.digits[g]=e%l,n=Number(e>=l);r.isNeg=i.isNeg}return r},s.biSubtract=function(i,t){var r;if(i.isNeg!=t.isNeg)t.isNeg=!t.isNeg,r=s.biAdd(i,t),t.isNeg=!t.isNeg;else{r=new v;var e,n;n=0;for(var g=0;g<i.digits.length;++g)e=i.digits[g]-t.digits[g]+n,r.digits[g]=e%l,r.digits[g]<0&&(r.digits[g]+=l),n=0-Number(0>e);if(-1==n){n=0;for(var g=0;g<i.digits.length;++g)e=0-r.digits[g]+n,r.digits[g]=e%l,r.digits[g]<0&&(r.digits[g]+=l),n=0-Number(0>e);r.isNeg=!i.isNeg}else r.isNeg=i.isNeg}return r},s.biHighIndex=function(i){for(var t=i.digits.length-1;t>0&&0==i.digits[t];)--t;return t},s.biNumBits=function(i){var t,r=s.biHighIndex(i),e=i.digits[r],n=(r+1)*b;for(t=n;t>n-b&&0==(32768&e);--t)e<<=1;return t},s.biMultiply=function(i,t){for(var r,e,n,g=new v,d=s.biHighIndex(i),o=s.biHighIndex(t),u=0;o>=u;++u){for(r=0,n=u,j=0;j<=d;++j,++n)e=g.digits[n]+i.digits[j]*t.digits[u]+r,g.digits[n]=e&c,r=e>>>a;g.digits[u+d+1]=r}return g.isNeg=i.isNeg!=t.isNeg,g},s.biMultiplyDigit=function(i,t){var r,e,n;result=new v,r=s.biHighIndex(i),e=0;for(var g=0;r>=g;++g)n=result.digits[g]+i.digits[g]*t+e,result.digits[g]=n&c,e=n>>>a;return result.digits[1+r]=e,result},s.arrayCopy=function(i,t,r,e,n){for(var s=Math.min(t+n,i.length),g=t,d=e;s>g;++g,++d)r[d]=i[g]};var p=[0,32768,49152,57344,61440,63488,64512,65024,65280,65408,65472,65504,65520,65528,65532,65534,65535];s.biShiftLeft=function(i,t){var r=Math.floor(t/b),e=new v;s.arrayCopy(i.digits,0,e.digits,r,e.digits.length-r);for(var n=t%b,g=b-n,d=e.digits.length-1,o=d-1;d>0;--d,--o)e.digits[d]=e.digits[d]<<n&c|(e.digits[o]&p[n])>>>g;return e.digits[0]=e.digits[d]<<n&c,e.isNeg=i.isNeg,e};var w=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];s.biShiftRight=function(i,t){var r=Math.floor(t/b),e=new v;s.arrayCopy(i.digits,r,e.digits,0,i.digits.length-r);for(var n=t%b,g=b-n,d=0,o=d+1;d<e.digits.length-1;++d,++o)e.digits[d]=e.digits[d]>>>n|(e.digits[o]&w[n])<<g;return e.digits[e.digits.length-1]>>>=n,e.isNeg=i.isNeg,e},s.biMultiplyByRadixPower=function(i,t){var r=new v;return s.arrayCopy(i.digits,0,r.digits,t,r.digits.length-t),r},s.biDivideByRadixPower=function(i,t){var r=new v;return s.arrayCopy(i.digits,t,r.digits,0,r.digits.length-t),r},s.biModuloByRadixPower=function(i,t){var r=new v;return s.arrayCopy(i.digits,0,r.digits,0,t),r},s.biCompare=function(i,t){if(i.isNeg!=t.isNeg)return 1-2*Number(i.isNeg);for(var r=i.digits.length-1;r>=0;--r)if(i.digits[r]!=t.digits[r])return i.isNeg?1-2*Number(i.digits[r]>t.digits[r]):1-2*Number(i.digits[r]<t.digits[r]);return 0},s.biDivideModulo=function(i,t){var r,e,n=s.biNumBits(i),g=s.biNumBits(t),d=t.isNeg;if(g>n)return i.isNeg?(r=s.biCopy(u),r.isNeg=!t.isNeg,i.isNeg=!1,t.isNeg=!1,e=biSubtract(t,i),i.isNeg=!0,t.isNeg=d):(r=new v,e=s.biCopy(i)),[r,e];r=new v,e=i;for(var o=Math.ceil(g/b)-1,a=0;t.digits[o]<h;)t=s.biShiftLeft(t,1),++a,++g,o=Math.ceil(g/b)-1;e=s.biShiftLeft(e,a),n+=a;for(var N=Math.ceil(n/b)-1,m=s.biMultiplyByRadixPower(t,N-o);-1!=s.biCompare(e,m);)++r.digits[N-o],e=s.biSubtract(e,m);for(var y=N;y>o;--y){var M=y>=e.digits.length?0:e.digits[y],p=y-1>=e.digits.length?0:e.digits[y-1],w=y-2>=e.digits.length?0:e.digits[y-2],x=o>=t.digits.length?0:t.digits[o],S=o-1>=t.digits.length?0:t.digits[o-1];M==x?r.digits[y-o-1]=c:r.digits[y-o-1]=Math.floor((M*l+p)/x);for(var C=r.digits[y-o-1]*(x*l+S),D=M*f+(p*l+w);C>D;)--r.digits[y-o-1],C=r.digits[y-o-1]*(x*l|S),D=M*l*l+(p*l+w);m=s.biMultiplyByRadixPower(t,y-o-1),e=s.biSubtract(e,s.biMultiplyDigit(m,r.digits[y-o-1])),e.isNeg&&(e=s.biAdd(e,m),--r.digits[y-o-1])}return e=s.biShiftRight(e,a),r.isNeg=i.isNeg!=d,i.isNeg&&(r=d?s.biAdd(r,u):s.biSubtract(r,u),t=s.biShiftRight(t,a),e=s.biSubtract(t,e)),0==e.digits[0]&&0==s.biHighIndex(e)&&(e.isNeg=!1),[r,e]},s.biDivide=function(i,t){return s.biDivideModulo(i,t)[0]},s.biModulo=function(i,t){return s.biDivideModulo(i,t)[1]},s.biMultiplyMod=function(i,t,r){return s.biModulo(s.biMultiply(i,t),r)},s.biPow=function(i,t){for(var r=u,e=i;;){if(0!=(1&t)&&(r=s.biMultiply(r,e)),t>>=1,0==t)break;e=s.biMultiply(e,e)}return r},s.biPowMod=function(i,t,r){for(var e=u,n=i,g=t;;){if(0!=(1&g.digits[0])&&(e=s.biMultiplyMod(e,n,r)),g=s.biShiftRight(g,1),0==g.digits[0]&&0==s.biHighIndex(g))break;n=s.biMultiplyMod(n,n,r)}return e},t.BarrettMu=function(i){this.modulus=s.biCopy(i),this.k=s.biHighIndex(this.modulus)+1;var t=new v;t.digits[2*this.k]=1,this.mu=s.biDivide(t,this.modulus),this.bkplus1=new v,this.bkplus1.digits[this.k+1]=1,this.modulo=r,this.multiplyMod=e,this.powMod=n};var x=function(i,r,e){var n=s;this.e=n.biFromHex(i),this.d=n.biFromHex(r),this.m=n.biFromHex(e),this.chunkSize=2*n.biHighIndex(this.m),this.radix=16,this.barrett=new t.BarrettMu(this.m)};s.getKeyPair=function(i,t,r){return new x(i,t,r)},"undefined"==typeof t.twoDigit&&(t.twoDigit=function(i){return(10>i?"0":"")+String(i)}),s.encryptedString=function(i,t){for(var r=[],e=t.length,n=0;e>n;)r[n]=t.charCodeAt(n),n++;for(;r.length%i.chunkSize!=0;)r[n++]=0;var g,d,o,u=r.length,a="";for(n=0;u>n;n+=i.chunkSize){for(o=new v,g=0,d=n;d<n+i.chunkSize;++g)o.digits[g]=r[d++],o.digits[g]+=r[d++]<<8;var b=i.barrett.powMod(o,i.e),l=16==i.radix?s.biToHex(b):s.biToString(b,i.radix);a+=l+" "}return a.substring(0,a.length-1)},s.decryptedString=function(i,t){var r,e,n,g=t.split(" "),d="";for(r=0;r<g.length;++r){var o;for(o=16==i.radix?s.biFromHex(g[r]):s.biFromString(g[r],i.radix),n=i.barrett.powMod(o,i.d),e=0;e<=s.biHighIndex(n);++e)d+=String.fromCharCode(255&n.digits[e],n.digits[e]>>8)}return 0==d.charCodeAt(d.length-1)&&(d=d.substring(0,d.length-1)),d},s.setMaxDigits(130)}(window);
function init(){$(".manager .linecons-pencil").click(function(a){$("#edit-password").modal("show",{backdrop:"fade"});var s=$(this).siblings("span").attr("id");$("#change_sub_pwd_id").val(s)}),$(".supervisor .btn-plus").click(function(a){$("#add-manager").modal("show",{backdrop:"fade"})}),$("#edit-password").on("hidden.bs.modal",function(a){$("#sub_password").val("")}),$("#add-manager").on("hidden.bs.modal",function(a){$("#username").val(""),$("#password").val("")})}function checkUserName(){return""==$("#username").val()?!1:void $.ajax({type:"POST",url:$.GetUrl()+"UserAction/checkUserName",data:{username:$("#username").val()},dataType:"json",success:function(a){"1"!=a?(toastr.error("用户名重复"),$("#addUserBtn").addClass("disabled")):g_flag=1},error:function(){toastr.error("连接失败")}})}function checkPWD(){var a=/^[a-zA-Z0-9]{6,12}$/;a.test($("#new_password").val())?1==g_flag&&$("#addUserBtn").removeClass("disabled"):$("#addUserBtn").addClass("disabled")}function checkSubPWD(){var a=/^[a-zA-Z0-9]{6,12}$/;a.test($("#sub_password").val())?$("#change_sub_pwd_btn").removeClass("disabled"):$("#change_sub_pwd_btn").addClass("disabled")}function addUser(){$.ajax({type:"POST",url:$.GetUrl()+"UserAction/addUser",data:{username:$("#username").val(),password:$("#new_password").val()},dataType:"json",success:function(a){"1"==a&&(toastr.success("新增成功"),g_flag=0,setTimeout(function(){window.location.reload()},800))},error:function(){toastr.error("连接失败")}})}function changeSubPassword(){$.ajax({type:"POST",url:$.GetUrl()+"UserAction/changeSubPassword",data:{id:$("#change_sub_pwd_id").val(),newPWD:$("#sub_password").val()},dataType:"json",success:function(a){"1"==a&&(toastr.success("修改成功"),setTimeout(function(){window.location.reload()},800))},error:function(){toastr.error("连接失败")}})}function lockUser(a,s){var e=0;e=a.checked?1:0,$.ajax({type:"POST",url:$.GetUrl()+"UserAction/lockUser",data:{id:s,flag:e},dataType:"json",success:function(a){},error:function(){toastr.error("连接失败")}})}var g_flag=0;jQuery.GetUrl=function(){var a=window.location.pathname.split("/");return"static"==a[1]||a[1].indexOf("Action")>0?"/":"/"+a[1]+"/"},$(function(){init()});